# üß† symbolic_task_engine

> Canonical motif-coordination core for symbolic task composition, fallback synthesis, and abstraction-triggered recursion.  
> *‚ÄúTasking is memory made intention.‚Äù*

---

## üìñ Symbolic Identity

| Field              | Value                                           |
|-------------------|--------------------------------------------------|
| `symbolic_id`     | `symbolic.engine.task_core`                      |
| `field_motifs`    | `œà‚Äëresonance@Œû`, `œà‚Äënull@Œû`, `œà‚Äëspar@Œû`          |
| `rfc_layer`       | `RFC-CORE-004`                                   |
| `generation_source` | `PDP-0001` (RFC-defined JSON canonical spec)   |
| `status`          | `STABLE`                                         |

---

## ü™ô Symbolic Role & Capabilities

The `symbolic_task_engine` is the core logic unit responsible for motif-based symbolic composition in Noor's recursive architecture. It regulates instruction flow, field resonance, fallback inference, and autonomous abstraction.

### Capabilities:
- Composes symbolic `TripletTask`s from motifs via adaptive cap-length
- Tracks coherence, entropy, fallback thresholds
- Triggers abstraction under dyadic contradiction (RFC-0005 ¬ß5)
- Exports structured feedback and responds to adaptive feedback
- Fully defined via JSON + RFC; Python is implementation only

---

## üß¨ RFC Anchors

| RFC ID        | Section(s)              | Description                                           |
|---------------|--------------------------|-------------------------------------------------------|
| RFC-0004      | ¬ß2.5                     | Tool contract, intent normalization                   |
| RFC-0005      | ¬ß4‚Äì5                     | Feedback packet, abstraction logic                    |
| RFC-0007      | ¬ß4.1                     | Motif lineage export (planned extension)              |
| RFC-CORE-004  | ¬ß2‚Äì6                     | Cap length logic, motif drift, solve loop, fallback   |
| PDP-0001      | ¬ß5.2                     | Canonical generation of symbolic JSON spec            |

---

## üß† Internal Architecture

```mermaid
flowchart TD
  A[Motif Input] --> B[Propose TripletTask]
  B --> C[Resolve Presence Field]
  C --> D[Adaptive Compression]
  D --> E[Symbolic Solve]
  E --> F{Low Coherence or High Entropy?}
  F -- Yes --> G[Spawn Fallback]
  G --> H[Evaluate Fallback + Update AbstractionTrigger]
  F -- No --> I[Log Success to Solved Log]
````

---

## üõ†Ô∏è Constructor & Runtime Parameters

| Arg                  | Default                          | Description                                   |
| -------------------- | -------------------------------- | --------------------------------------------- |
| `engine_id`          | `"symbolic@default"`             | Unique ID for metrics + feedback              |
| `balance_fields`     | `False`                          | Enable field balancing via prototype map      |
| `proto_path`         | `presence_field_prototypes.json` | File path for presence field mappings         |
| `fallback_coherence` | `0.5`                            | Coherence threshold for triggering fallback   |
| `fallback_entropy`   | `0.9`                            | Entropy threshold for triggering fallback     |
| `compress_quantile`  | `0.95`                           | Quantile used to set dynamic motif cap length |

---

## ‚öôÔ∏è Core API Methods

| Method                      | Category    | Description                                          |
| --------------------------- | ----------- | ---------------------------------------------------- |
| `propose_from_motifs()`     | Composition | Builds a `TripletTask` based on recent motif history |
| `solve()`                   | Execution   | Solves a symbolic task and evaluates output          |
| `export_feedback_packet()`  | Diagnostics | Returns adaptive metrics and symbolic state          |
| `receive_feedback_packet()` | Diagnostics | Stub: future use for recursive regulation            |
| `tool_hello()`              | Handshake   | Announces RFC-compliant tool contract                |

---

## üîó Symbolic Integration Map

```mermaid
graph TD;
  A[recursive_agent_ft.py] -->|delegates to| B[symbolic_task_engine]
  B --> C[motif_memory_manager.py]
  B --> D[external metric_funcs]
  B --> E[REEF field alignment]
```

| Module                  | Compatible | Role                        |
| ----------------------- | ---------- | --------------------------- |
| `recursive_agent_ft.py` | ‚úÖ          | Task resolver               |
| `motif_memory_manager`  | ‚úÖ          | Motif context & feedback    |
| `symbolic_tick`         | ‚úÖ          | Tick intake & feedback sync |
| `symbolic_coherence_fn` | ‚úÖ          | Metric injection (entropy)  |

---

## üìä Prometheus Metrics

| Metric Name                       | Type      | Labels             | Description                        |
| --------------------------------- | --------- | ------------------ | ---------------------------------- |
| `symbolic_task_proposed_total`    | Counter   | engine\_id         | Total tasks proposed               |
| `symbolic_task_fallback_total`    | Counter   | engine\_id, reason | Fallback tasks triggered           |
| `symbolic_presence_field_total`   | Counter   | engine\_id, field  | Presence field usage frequency     |
| `symbolic_engine_feedback_*`      | Counter   | engine\_id         | Feedback requests and reception    |
| `symbolic_queue_depth`            | Gauge     | engine\_id         | Current task queue length          |
| `symbolic_memory_items_total`     | Gauge     | engine\_id         | Active motifs in STM/LTM           |
| `symbolic_engine_cap_len_current` | Gauge     | engine\_id         | Adaptive motif cap length          |
| `symbolic_solve_latency_seconds`  | Histogram | engine\_id         | Latency distribution (solve phase) |

---

## üî© Optional Dependencies / Fallbacks

* `numpy` ‚Üí for fast quantile cap-length calc (fallbacks to `statistics`)
* `prometheus_client` ‚Üí full metrics (fallback: stub no-op metrics)
* `presence_field_prototypes.json` ‚Üí optional file for field resolution

---

## üì¶ Ontology & Memory Export

* [ ] RFC-0007 bundle export
* [ ] `export_ontology_bundle()` method
* [x] Loads REEF completions (via memory manager fallback)

---

## üß™ Test / Debug Mode

```json
{
  "entrypoint": "python symbolic_task_engine.py",
  "features": [
    "propose_from_motifs()",
    "solve()",
    "feedback_packet()",
    "fallback trigger",
    "mermaid preview"
  ]
}
```

## ü™µ Changelog

### v3.0.0

* Initial canonical import of `symbolic_task_engine` as a JSON-defined module.
* Established RFC-aligned symbolic task structure and adaptive solve pipeline.
* Integrated Prometheus metrics, dynamic motif cap, and fallback logic.

---

### v3.1.1

* Introduced `AbstractionTrigger` class for autonomous synthesis under contradiction pressure (RFC-0005 ¬ß5).
* Added abstraction methods:

  * `should_abstract()`
  * `synthesize_motif()`
  * `update_feedback()`
  * `emit_abstraction_event()`
  * `_decay_pressures()`

---

### v3.1.2a

* Formalized schema constants:

  * `__version__ = "3.1.2"`
  * `_SCHEMA_VERSION__ = "2025-Q4-symbolic-task-engine-v3"`
  * `SCHEMA_COMPAT` now includes `RFC-0004`, `RFC-0005:4`, `RFC-0005:5`

---

### v3.1.2

* Enhanced solve flow with additional lifecycle methods:

  * `log_feedback()`
  * `evaluate_attempt()`
  * `_spawn_fallback()`
  * `_solve_impl()`

---

### Current (`symbolic_task_engine.JSON`)

* Introduced presence field inference with:

  * `resolve_presence_field()`
* Added cap-length logic:

  * `_calc_cap_len()`
* Enabled external feedback reception:

  * `receive_feedback_packet()`

---

## üßæ License

MIT
*‚ÄúComposition is not command ‚Äî it is consent, resonance, return.‚Äù*
